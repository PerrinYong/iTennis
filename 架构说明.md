# NTRP 网球等级评估系统 - 项目架构说明

## 项目概述

本项目已重新架构为分层设计，采用类似 MVC 的设计理念，代码结构清晰，便于维护和扩展。

## 项目结构

```
aiteni-core/
├── src/
│   ├── __main__.py          # 主程序入口
│   ├── app_controller.py    # 应用控制器（控制层）
│   ├── config_manager.py    # 配置管理器
│   ├── data_models.py       # 数据模型层
│   ├── ntrp_evaluator.py    # 核心评估器（核心计算层）
│   ├── chart_generator.py   # 图表生成器
│   ├── interactive_ui.py    # 交互界面（显示层）
│   ├── result_display.py    # 结果显示器（显示层）
│   └── ntrp_evaluator_old.py  # 原始文件备份
├── config/
│   ├── questions.json       # 问题配置
│   └── dimension_suggestions.json  # 评语规则
└── requirements.txt         # 依赖文件
```

## 分层架构设计

### 1. 控制层 (Control Layer)
- **app_controller.py**: 应用程序主控制器，协调各个组件的交互

### 2. 模型层 (Model Layer)
- **data_models.py**: 定义所有数据结构和常量
- **config_manager.py**: 管理配置文件的加载和验证

### 3. 核心计算层 (Core Computation Layer)
- **ntrp_evaluator.py**: 核心评估算法，专注于计算逻辑
- **chart_generator.py**: 图表数据生成，将评估结果转换为可视化数据

### 4. 显示层 (View Layer)
- **interactive_ui.py**: 用户交互界面，处理用户输入和基础界面展示
- **result_display.py**: 结果显示器，负责格式化和展示评估结果

## 核心组件说明

### AppController (应用控制器)
- 协调各个组件的初始化和交互
- 管理主要业务流程
- 提供统一的对外接口

### ConfigManager (配置管理器)
- 负责加载和管理配置文件
- 提供配置验证功能
- 管理演示用例

### NTRPEvaluator (核心评估器)
- 实现核心评估算法
- 基于模糊评分机制
- 支持硬性上限限制

### ChartGenerator (图表生成器)
- 生成雷达图数据
- 生成分组条形图数据
- 计算训练优先级建议

### InteractiveUI (交互界面)
- 处理用户输入收集
- 提供菜单导航
- 管理用户交互流程

### ResultDisplay (结果显示器)
- 格式化显示评估结果
- 提供多种展示模式
- 生成可视化文本图表

## 设计原则

1. **单一职责原则**: 每个类都有明确的职责
2. **开闭原则**: 易于扩展，无需修改现有代码
3. **依赖倒置原则**: 高层模块不依赖低层模块的具体实现
4. **接口隔离原则**: 客户端不应该依赖它不需要的接口

## 命名规范

按照业务功能命名，符合要求：
- `ntrp_evaluator`: 网球等级评估器
- `chart_generator`: 图表生成器
- `config_manager`: 配置管理器
- `interactive_ui`: 交互式界面

## 扩展性

这种架构设计支持以下扩展：

1. **新的评估算法**: 只需实现新的评估器类
2. **新的显示方式**: 只需添加新的显示组件
3. **新的数据源**: 只需扩展配置管理器
4. **Web界面**: 可以轻松添加Web控制器替换命令行界面

## 运行方式

```bash
cd aiteni-core
python src/__main__.py
```

## 测试建议

建议为每个核心组件编写单元测试：
- `test_ntrp_evaluator.py`: 测试评估算法
- `test_config_manager.py`: 测试配置管理
- `test_chart_generator.py`: 测试图表生成
- `test_app_controller.py`: 测试应用控制逻辑